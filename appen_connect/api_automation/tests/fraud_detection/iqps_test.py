import time

import pytest

from adap.ui_automation.utils.selenium_utils import set_up_driver
from appen_connect.api_automation.services_config.ipqs import AC_IPQS_API

mark_only_envs = pytest.mark.skipif(
    pytest.env not in ["stage"],
    reason="Only AC Stage enabled feature")

API_IPQS = AC_IPQS_API()
cookies = {
        "AWSELBAuthSessionCookie-0":"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"
    }


def test_ipqs_healthcheck():
    ipqs_res = API_IPQS.get_healthcheck(cookies=cookies)
    ipqs_res.assert_response_status(200)

    assert ipqs_res.json_response['status'] == 'pass'
    assert ipqs_res.json_response['app-name'] == 'IP Quality Service'
    assert ipqs_res.json_response['version']
    assert ipqs_res.json_response['last_release_date']


def test_check_ip():
    ipqs_res = API_IPQS.get_check_ip('192.168.17.43', cookies=cookies)
    ipqs_res.assert_response_status(200)
    assert ipqs_res.json_response['ip'] == '192.168.17.43'


def test_check_ip_invalid():
    ipqs_res = API_IPQS.get_check_ip('192.168.17.oo', cookies=cookies)
    ipqs_res.assert_response_status(400)
    assert ipqs_res.json_response == {'detail': 'The IP 192.168.17.oo is invalid'}


# 1297459
# sandbox+new_account_62724494700@figure-eight.com